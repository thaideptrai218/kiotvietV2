### Kiotviet Authentication API Tests
### Base URL: http://localhost:8080

### Variables
@baseUrl = http://localhost:8080
@companyName = TestCompany123
@companyEmail = test1@company.com
@companyPhone = 0123456789
@companyAddress = 123 Test Street, Ho Chi Minh City
@taxCode = 123456789
@username = testuser123
@email = testuser@test.com
@fullName = Test User
@phone = 0987654321
@password = ThaiDinh218@
@role = admin

### ====================================================================
### 1. USER REGISTRATION TESTS
### ====================================================================

### 1.1 Register a new user (should succeed)
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "companyName": "{{companyName}}",
  "companyEmail": "{{companyEmail}}",
  "companyPhone": "{{companyPhone}}",
  "companyAddress": "{{companyAddress}}",
  "taxCode": "{{taxCode}}",
  "username": "{{username}}",
  "email": "{{email}}",
  "fullName": "{{fullName}}",
  "phone": "{{phone}}",
  "password": "{{password}}",
  "role": "{{role}}"
}

### 1.2 Register duplicate user (should fail - company already exists)
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "companyName": "{{companyName}}",
  "companyEmail": "different@company.com",
  "companyPhone": "0987654321",
  "companyAddress": "Different Address",
  "taxCode": "987654321",
  "username": "differentuser",
  "email": "different@user.com",
  "fullName": "Different User",
  "phone": "0123456789",
  "password": "SecurePass123!",
  "role": "admin"
}

### 1.3 Register with invalid email (should fail)
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "companyName": "Another Company123123",
  "companyEmail": "welterial123123@gmail.com",
  "companyPhone": "0987654321",
  "companyAddress": "Test Address",
  "taxCode": "123456789",
  "username": "anotheruser",
  "email": "welterial123123@gmail.com",
  "fullName": "Another User",
  "phone": "0123456789",
  "password": "SecurePass123",
  "role": "manager"
}

### 1.4 Register with weak password (should fail)
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "companyName": "Weak Password Company",
  "companyEmail": "weak@company.com",
  "companyPhone": "0987654321",
  "companyAddress": "Test Address",
  "taxCode": "123456789",
  "username": "weakuser",
  "email": "weak@user.com",
  "fullName": "Weak User",
  "phone": "0123456789",
  "password": "weak",
  "role": "staff"
}

### 1.5 Register with missing required fields (should fail)
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "companyName": "",
  "companyEmail": "missing@company.com",
  "companyPhone": "0987654321",
  "companyAddress": "Test Address",
  "taxCode": "123456789",
  "username": "",
  "email": "missing@user.com",
  "fullName": "Missing User",
  "phone": "0123456789",
  "password": "SecurePass123!",
  "role": "admin"
}

### ====================================================================
### 2. LOGIN TESTS
### ====================================================================

### 2.1 Login with valid credentials (should succeed)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "{{username}}",
  "password": "{{password}}"
}

### 2.2 Login with invalid username (should fail)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "wronguser",
  "password": "{{password}}"
}

### 2.3 Login with invalid password (should fail)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "{{username}}",
  "password": "wrongpassword"
}

### 2.4 Login with empty username (should fail)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "",
  "password": "{{password}}"
}

### 2.5 Login with empty password (should fail)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "{{username}}",
  "password": ""
}

### 2.6 Login with malformed JSON (should fail)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "{{username}}",
  "password": "{{password}}"